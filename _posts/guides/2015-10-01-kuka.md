---
layout: guide
title:  "KUKA"
updated:   2016-04-04
categories: guides
tags:
- robotics
- industrial robotics
- code
- programming
- autmation
---

There is a free editor called
[OrangeEdit](http://www.orangeapps.de/?lng=en&page=apps/orangeedit) which can
make writing KRL code a bit easier.

## KR C2
* Accessing windows: `CTRL+ESC`
* Turning it off: If the batteries are good, pull the switch down. Can change options for whether it will hibernate, cold shutdown, or warm shutdown
* Backing up:
    * Put in a USB DRIVE
    * Go into Windows (`CTRL+ESC`)
    * run and configure via: C:\KRC\UTIL\KRCCONFIGURATOR\KrcConfigurator.exe
    * As an expert, file->archive->all

## KR C4

### Important commands:
- View Windows : RobotKey->Startup->Service->Minimize HMI
- [Change Logout time](http://www.robot-forum.com/robotforum/kuka-robot-forum/krc4-logout-time/)

### RSI (Specifically RSI 32)

#### Setup
This will help you setup and run the KUKA provided RSI example for Ethernet
control. You will need a PC running modern Windows. You can find the KUKA RSI
examples as well as RSI visual in: `D:\KUKA_OPT\RSI` on your KRC4 controller
(after you have installed RSI). Specifically, we will be
working with the example at `D:\KUKA_OPT\RSI\DOC\Examples\Ethernet`

1. Connect NIC on PC to KLI port in controller via CAT 5 cable
2. Copy files from `D:\KUKA_OPT\RSI\DOC\Examples\Ethernet\Config` to
   `C:\KRC\Roboter\Config\user\common\SensorInterface`
3. Modify the `RSI_EthernetConfig.xml` file to have the `IP_NUMBER` set to 10.100.1.2
3. Enter `Expert Mode`
4. Add a new virtual adapter for windows if one does not already exist (This
    will be the KLI adapter) This can be done manually:
    1. RobotButton -> Startup -> Network Configuration
    2. The first page should say: `Fixed IP Address`, `172.31.1.147`, `255.255.255.0`,
       `172.31.1.47`
    2. Click `Advanced`
    3. Select the adapter for the 172.31.1.147 adapter and click `windows interface`
    4. Click `Add interface`
    5. Change the new interface to be named `RSI`
    6. Set the address type to `real-time IP address`
    7. Set the IP address to `10.100.1.1`
    8. Set the subnet mask to `255.255.255.0`
    9. Click `User-defined filters`
    10. Add a filter set to type `IP protocol`, address: `10.100.1.1`, subnet:
        `255.255.255.0`, parameters: `17`
5. This can also be done automatically:
    6. Minimize the HMI (startup->service->minimize HMI)
    7. Click the windows button -> all programs -> RSI-Network
    8. Under RSI Ethernet, select `New` then click `Edit`
    9. Type in `10.100.1.1`
    10. Check to see that everything got setup properly per the manual instructions
6. On the PC, set the IP address to `10.100.1.2`, subnet to `255.255.255.0`,
   Default gateway to `10.100.1.1`, turn of DHCP
7. Copy the `RSI_Ethernet.src` file from
   `D:\KUKA_OPT\RSI\DOC\Examples\Ethernet\` to the KRC4 programs folder.
8. Alter the home points in the `RSI_Ethernet.src` file to be appropriate for
   your setup.
9. Copy the `D:\KUKA_OPT\RSI\DOC\Examples\Ethernet\Server.exe` file to your
   computer.
8. Run the `Server.exe` file, and press the play button
9. Place the robot into automatic mode 
9. Run the `RSI_Ethernet.src` file on the KRC4

If you have problems, there is some debugging you can do:

- Try pinging in both directions
    - From your PC: `windowskey`+`R`, `cmd.exe`->`enter`, `ping 10.100.1.1`->enter
    - From KRC4:
        1. Minimize HMI
        2. Press windows button
        3. Select `All Programs`
        4. Select `Accessories`
        5. Select `cmd`
        6. Type `ping 10.100.1.2`->enter
- Try disabling the firewall on your PC
- Check the Network Configuration page on the KRC4 for accuracy

#### Just some info
- Always uses UDP
- Configured via XML files (should use RSI visual as an abstraction to a GUI)
    - <project>.rsi
    - <project>.rsi.diagram
    - <project>.rsi.xml
- Order of packets is very Important
- The RSI Context can do a lot of different types of signal processing
    - Setup via RSI visual
- Ethernet Object
    - 64 I/O points
    - Configured via XML file (pg 43)
        - Referenced by Ethernet Object in RSI visual
        - Keywords:
            - DEF_RIst
                - Cartesian actual position
            - DEF_RSol
                - Cartesian setpoint
            - DEF_Delay
                - Number of late data packets
            - additional on pg 47-48
            - DEF_EStr
                - Allows writing of error and notifications on the controller
                - <EStr>xxx</Estr>
                    - Writes a notification
                - <EStr>Error:xxx</EStr>
                    - Acknowledgement message
                    - Will stop the robot
                - <EStr/>
                    - No message/error
    - Server (computer) must respond to client (KR C4) within either 4 or 12 ms
      depending on whether using slow or fast mode.
- Can perform corrections on movements within a program. When in IPO mode, this only works on lin and circ moves.
- Can do motion control from external system (still called a correction)
    - Can be absolute (takes pose at RSI_ON as <0...0>)
    - Can be relative (from current position)
    - RSI_MOVECORR()
- Safety
    - Software limits will work (per manual pg 21)
    - There are limits on MAX corrections
        - These can easily get in the way though
- Global Variables
    - RSIERRMSG
        - True: RSI Errors are displayed on the TP
        - False: No messages, errors must be handled by the KRL program
- RSITECHIDX
    - Defines which function generator RSI will use
- RSI monitor
    - Can be used to visualize, monitor, and record signals across RSI Interface
    - Display->RSI monitor
- Logging
    - `C:\KRC\Roboter\config\user\common\Logging-RSI.xml`
        - `<class Name = "RSILogger | LogLevel=[<error>|<info>]"`
- One liner guide on pg 69


#### What do you need to use RSI:
- Robot Sensor Interface on KRC4
- An external windows PC with RSI visual for setup (can use linux et al for
    actual running).
